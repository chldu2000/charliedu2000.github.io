import{_ as d}from"./ValaxyMain.vue_vue_type_style_index_0_lang-40050c3d.js";import{_ as C,c as A,w as e,o as r,b as s,d as l,e as c,a as x,r as o,f as h,p as u}from"./app-025bdceb.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-dd4500d1.js";import"./YunCard.vue_vue_type_style_index_0_lang-c0980680.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-870a2da2.js";const Ce=JSON.parse('{"title":"BombLab实验","description":"","frontmatter":{"title":"BombLab实验","categories":["快去学习"],"tags":["学习笔记"],"draft":false,"slug":"74","date":"2021-05-14T23:52:00.000Z","updated":"2021-05-14T23:52:00.000Z"},"headers":[{"level":2,"title":"拆掉邪恶博士的炸弹","slug":"拆掉邪恶博士的炸弹","link":"#拆掉邪恶博士的炸弹","children":[{"level":3,"title":"邪恶博士的幽默感","slug":"邪恶博士的幽默感","link":"#邪恶博士的幽默感","children":[]},{"level":3,"title":"第一关","slug":"第一关","link":"#第一关","children":[]},{"level":3,"title":"第二关","slug":"第二关","link":"#第二关","children":[]},{"level":3,"title":"第三关","slug":"第三关","link":"#第三关","children":[]},{"level":3,"title":"第四关","slug":"第四关","link":"#第四关","children":[]},{"level":3,"title":"第五关","slug":"第五关","link":"#第五关","children":[]},{"level":3,"title":"第六关","slug":"第六关","link":"#第六关","children":[]},{"level":3,"title":"隐藏关卡","slug":"隐藏关卡","link":"#隐藏关卡","children":[]},{"level":3,"title":"通关","slug":"通关","link":"#通关","children":[]}]}],"relativePath":"pages/posts/learning/csapp_bomblab.md","path":"/home/runner/work/charliedu2000.github.io/charliedu2000.github.io/pages/posts/learning/csapp_bomblab.md","lastUpdated":1699970883000}'),p=JSON.parse('{"title":"BombLab实验","description":"","frontmatter":{"title":"BombLab实验","categories":["快去学习"],"tags":["学习笔记"],"draft":false,"slug":"74","date":"2021-05-14T23:52:00.000Z","updated":"2021-05-14T23:52:00.000Z"},"headers":[{"level":2,"title":"拆掉邪恶博士的炸弹","slug":"拆掉邪恶博士的炸弹","link":"#拆掉邪恶博士的炸弹","children":[{"level":3,"title":"邪恶博士的幽默感","slug":"邪恶博士的幽默感","link":"#邪恶博士的幽默感","children":[]},{"level":3,"title":"第一关","slug":"第一关","link":"#第一关","children":[]},{"level":3,"title":"第二关","slug":"第二关","link":"#第二关","children":[]},{"level":3,"title":"第三关","slug":"第三关","link":"#第三关","children":[]},{"level":3,"title":"第四关","slug":"第四关","link":"#第四关","children":[]},{"level":3,"title":"第五关","slug":"第五关","link":"#第五关","children":[]},{"level":3,"title":"第六关","slug":"第六关","link":"#第六关","children":[]},{"level":3,"title":"隐藏关卡","slug":"隐藏关卡","link":"#隐藏关卡","children":[]},{"level":3,"title":"通关","slug":"通关","link":"#通关","children":[]}]}],"relativePath":"pages/posts/learning/csapp_bomblab.md","path":"/home/runner/work/charliedu2000.github.io/charliedu2000.github.io/pages/posts/learning/csapp_bomblab.md","lastUpdated":1699970883000}'),y={name:"pages/posts/learning/csapp_bomblab.md",data(){return{data:p,frontmatter:p.frontmatter}},setup(){u("pageData",p)}},b={id:"拆掉邪恶博士的炸弹",tabindex:"-1"},_=s("blockquote",null,[s("p",null,"这是一个课程实验，感觉有点意思，就记录一下吧。"),s("p",null,"分析可能不准确，仅供参考。")],-1),D={id:"邪恶博士的幽默感",tabindex:"-1"},m=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/***************************************************************************")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * Dr. Evil's Insidious Bomb, Version 1.1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * Copyright 2011, Dr. Evil Incorporated. All rights reserved.")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," *")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * LICENSE:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," *")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * Dr. Evil Incorporated (the PERPETRATOR) hereby grants you (the")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * VICTIM) explicit permission to use this bomb (the BOMB).  This is a")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * time limited license, which expires on the death of the VICTIM.")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * The PERPETRATOR takes no responsibility for damage, frustration,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * insanity, bug-eyes, carpal-tunnel syndrome, loss of sleep, or other")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * harm to the VICTIM.  Unless the PERPETRATOR wants to take credit,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * that is.  The VICTIM may not distribute this bomb source code to")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * any enemies of the PERPETRATOR.  No VICTIM may debug,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},' * reverse-engineer, run "strings" on, decompile, decrypt, or use any')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * other technique to gain knowledge of and defuse the BOMB.  BOMB")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * proof clothing may not be worn when handling this program.  The")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * PERPETRATOR will not apologize for the PERPETRATOR's poor sense of")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * humor.  This license is null and void where the BOMB is prohibited")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * by law.")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," ***************************************************************************/")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),f=s("p",null,"满满的中二之感，连我都看不惯了，解之。",-1),g=s("p",null,[l("由于我们并没有完整的源代码，只能通过汇编代码来尝试推出博士"),s("s",null,"这个邪恶的刀客塔"),l("到底在炸弹里做了些什么手脚了。")],-1),v={id:"第一关",tabindex:"-1"},$=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/* Hmm...  Six phases must be more secure than one phase! */")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),k=s("p",null,"邪恶博士的第一个关卡如下",-1),j=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048b50 <phase_1>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b50:   83 ec 1c                sub    $0x1c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b53:   c7 44 24 04 64 a1 04    movl   $0x804a164,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b5a:   08 ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b5b:   8b 44 24 20             mov    0x20(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b5f:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b62:   e8 2d 04 00 00          call   8048f94 <strings_not_equal>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b67:   85 c0                   test   %eax,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b69:   74 05                   je     8048b70 <phase_1+0x20>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b6b:   e8 36 05 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b70:   83 c4 1c                add    $0x1c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b73:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),T=s("p",null,"看起来很短，大概是这样的：",-1),w=s("p",null,[l("把输入的内容传给了"),s("code",null,"phase_1"),l("，根据"),s("code",null,"phase_1"),l("调用了"),s("code",null,"<strings_not_equal>"),l("猜想这里应该是把输入的字符串和某个字符串作比较，下面"),s("code",null,"test %eax,%eax"),l("，当"),s("code",null,"%eax"),l("为0时跳过"),s("code",null,"<explode_bomb>"),l("，即"),s("code",null,"<strings_not_equal>"),l("的返回值为0，两个字符串相等时跳过。")],-1),I=s("p",null,[l("在"),s("code",null,"<strings_not_equal>"),l("之前可以看到"),s("code",null,"movl $0x804a164,0x4(%esp)"),l("，将这个立即数作为地址。使用gdb调试bomb程序，输入"),s("code",null,"x/s 0x804a164"),l("，终端显示了"),s("code",null,'0x804a164: "Crikey! I have lost my mojo!"'),l("。")],-1),E=s("p",null,[l("再往下是"),s("code",null,"mov 0x20(%esp),%eax"),l("，把手动输入的字符串的地址放进"),s("code",null,"%eax"),l("，再放到"),s("code",null,"(%esp)"),l("，传给了"),s("code",null,"<strings_not_equal>"),l("。猜测需要输入的正确答案就是"),s("code",null,"0x804a164"),l("处的字符串"),s("code",null,"Crikey! I have lost my mojo!"),l("。")],-1),R=s("p",null,[l("在"),s("code",null,"<explode_bomb>"),l("前设置断点，"),s("code",null,"break explode_bomb"),l("，输入run运行程序。输入字符串"),s("code",null,"Crikey! I have lost my mojo!"),l("，终端显示"),s("code",null,"Phase 1 defused. How about the next one?"),l("，第一关通过。")],-1),B=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/xodRVhpKkq7BUI5.jpg",alt:"phase1"})],-1),P={id:"第二关",tabindex:"-1"},O=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/* The second phase is harder.  No one will ever figure out")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * how to defuse this... */")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),M=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048b74 <phase_2>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b74:   56                      push   %esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b75:   53                      push   %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b76:   83 ec 34                sub    $0x34,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b79:   8d 44 24 18             lea    0x18(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b7d:   89 44 24 04             mov    %eax,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b81:   8b 44 24 40             mov    0x40(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b85:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b88:   e8 4e 06 00 00          call   80491db <read_six_numbers>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b8d:   83 7c 24 18 00          cmpl   $0x0,0x18(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b92:   75 07                   jne    8048b9b <phase_2+0x27>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b94:   83 7c 24 1c 01          cmpl   $0x1,0x1c(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b99:   74 05                   je     8048ba0 <phase_2+0x2c>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048b9b:   e8 06 05 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),V=s("p",null,[l("由"),s("code",null,"<read_six_numbers>"),l("可以猜想第二关要输入六个数。紧接着是"),s("code",null,"cmpl $0x0,0x18(%esp)"),l("和"),s("code",null,"jne 8048b9b <phase_2+0x27>"),l("，而"),s("code",null,"8048b9b"),l("处就是调用"),s("code",null,"<explode_bomb>"),l("，也就是说如果第一个数不等于0就爆炸，所以第一个数是0。")],-1),q=s("p",null,[l("再往下是"),s("code",null,"cmpl $0x1,0x1c(%esp)"),l("和"),s("code",null,"je 8048ba0 <phase_2+0x2c>"),l("，第二个数等于1就跳过爆炸。")],-1),N=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048ba0:   8d 5c 24 20             lea    0x20(%esp),%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ba4:   8d 74 24 30             lea    0x30(%esp),%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ba8:   8b 43 f8                mov    -0x8(%ebx),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bab:   03 43 fc                add    -0x4(%ebx),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bae:   39 03                   cmp    %eax,(%ebx)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bb0:   74 05                   je     8048bb7 <phase_2+0x43>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bb2:   e8 ef 04 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bb7:   83 c3 04                add    $0x4,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bba:   39 f3                   cmp    %esi,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bbc:   75 ea                   jne    8048ba8 <phase_2+0x34>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bbe:   83 c4 34                add    $0x34,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bc1:   5b                      pop    %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bc2:   5e                      pop    %esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bc3:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),S=s("p",null,[l("接着是循环遍历剩下的数，由"),s("code",null,"mov -0x8(%ebx),%eax"),l("、"),s("code",null,"add -0x4(%ebx),%eax"),l("、"),s("code",null,"cmp %eax,(%ebx)"),l("可以发现是用当前数与它前面两个数之和比较，相等就不爆炸，也就是说输入的数应该组成斐波那契数列，已经有了0和1，剩下的应该是1、2、3、5。")],-1),Z=s("p",null,[l("在终端输入"),s("code",null,"0 1 1 2 3 5"),l("，终端输出了"),s("code",null,"That's number 2. Keep going!"),l("，第二关通过。")],-1),L=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/yXM4Omd15wWbu8V.jpg",alt:"phase2"})],-1),U={id:"第三关",tabindex:"-1"},W=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/* I guess this is too easy so far.  Some more complex code will")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * confuse people. */")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),z=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048bc4 <phase_3>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bc4:   83 ec 2c                sub    $0x2c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bc7:   8d 44 24 1c             lea    0x1c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bcb:   89 44 24 0c             mov    %eax,0xc(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bcf:   8d 44 24 18             lea    0x18(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bd3:   89 44 24 08             mov    %eax,0x8(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bd7:   c7 44 24 04 8b a3 04    movl   $0x804a38b,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bde:   08 ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bdf:   8b 44 24 30             mov    0x30(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048be3:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048be6:   e8 85 fc ff ff          call   8048870 <__isoc99_sscanf@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048beb:   83 f8 01                cmp    $0x1,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bee:   7f 05                   jg     8048bf5 <phase_3+0x31>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bf0:   e8 b1 04 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),H=s("p",null,[l("由"),s("code",null,"movl $0x804a38b,0x4(%esp)"),l("可以猜想"),s("code",null,"0x804a38b"),l("中保存的内容与"),s("code",null,"sscanf"),l("有关。在gdb中输入"),s("code",null,"x/s 0x804a38b"),l("，终端输出了"),s("code",null,'0x804a38b: "%d %d"'),l("，猜想应该输入两个整数，"),s("code",null,"sscanf"),l("的返回值与1比较，返回值（输入数的个数）大于1才能不爆炸。")],-1),Y=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048bf5:   83 7c 24 18 07          cmpl   $0x7,0x18(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048bfa:   77 3c                   ja     8048c38 <phase_3+0x74>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),K=s("p",null,"输入的第一个数与7比较，小于等于7才不爆炸。",-1),X=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048bfc:   8b 44 24 18             mov    0x18(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c00:   ff 24 85 a0 a1 04 08    jmp    *0x804a1a0(,%eax,4)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),J=s("p",null,[l("猜测是"),s("code",null,"switch"),l("，使用以"),s("code",null,"*0x804a1a0"),l("为基址的跳转表。")],-1),Q=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048c07:   b8 f5 02 00 00          mov    $0x2f5,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c0c:   eb 3b                   jmp    8048c49 <phase_3+0x85>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c0e:   b8 ad 03 00 00          mov    $0x3ad,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c13:   eb 34                   jmp    8048c49 <phase_3+0x85>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c15:   b8 0e 02 00 00          mov    $0x20e,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c1a:   eb 2d                   jmp    8048c49 <phase_3+0x85>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c1c:   b8 e3 03 00 00          mov    $0x3e3,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c21:   eb 26                   jmp    8048c49 <phase_3+0x85>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c23:   b8 e0 03 00 00          mov    $0x3e0,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c28:   eb 1f                   jmp    8048c49 <phase_3+0x85>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c2a:   b8 a3 02 00 00          mov    $0x2a3,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c2f:   eb 18                   jmp    8048c49 <phase_3+0x85>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c31:   b8 5e 01 00 00          mov    $0x15e,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c36:   eb 11                   jmp    8048c49 <phase_3+0x85>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c38:   e8 69 04 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c3d:   b8 00 00 00 00          mov    $0x0,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c42:   eb 05                   jmp    8048c49 <phase_3+0x85>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c44:   b8 13 03 00 00          mov    $0x313,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c49:   3b 44 24 1c             cmp    0x1c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c4d:   74 05                   je     8048c54 <phase_3+0x90>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c4f:   e8 52 04 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c54:   83 c4 2c                add    $0x2c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c57:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),F=s("p",null,[l("输入"),s("code",null,"p/x *0x804a1a0"),l("，终端输出了"),s("code",null,'"$1 = 0x8048c07"'),l("，那么第一个数是0时，第二个数应该是"),s("code",null,"0x8048c07"),l("处"),s("code",null,"mov $0x2f5,%eax"),l("对应的数0x2f5，转换成十进制就是757。当第一个数是其他值时第二个数会有不同，比如当第一个数是2，通过"),s("code",null,"p/x *0x804a1a8"),l("得到"),s("code",null,"$3 = 0x8048c0e"),l("，第二个数应该是0x3ad，转换成十进制是941，其他情况不再一一列出。")],-1),G=s("p",null,[l("输入"),s("code",null,"0 757"),l("，终端输出了"),s("code",null,"Halfway there!"),l("，第三关通过，答案不唯一。")],-1),ss=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/kXyj7TLxtaJEIB3.jpg",alt:"phase3"})],-1),ls={id:"第四关",tabindex:"-1"},es=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/* Oh yeah?  Well, how good is your math?  Try on this saucy problem! */")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ns=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048cb5 <phase_4>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cb5:   83 ec 2c                sub    $0x2c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cb8:   8d 44 24 18             lea    0x18(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cbc:   89 44 24 0c             mov    %eax,0xc(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cc0:   8d 44 24 1c             lea    0x1c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cc4:   89 44 24 08             mov    %eax,0x8(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cc8:   c7 44 24 04 8b a3 04    movl   $0x804a38b,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ccf:   08 ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cd0:   8b 44 24 30             mov    0x30(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cd4:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cd7:   e8 94 fb ff ff          call   8048870 <__isoc99_sscanf@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cdc:   83 f8 02                cmp    $0x2,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cdf:   75 0e                   jne    8048cef <phase_4+0x3a>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ce1:   8b 44 24 18             mov    0x18(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ce5:   83 f8 01                cmp    $0x1,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ce8:   7e 05                   jle    8048cef <phase_4+0x3a>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),as=s("p",null,[l("根据"),s("code",null,"movl $0x804a38b,0x4(%esp)"),l("，输入"),s("code",null,"x/s 0x804a38b"),l("，得到"),s("code",null,'"0x804a38b: "%d %d""'),l("，猜想应该输入两个整数。接下来"),s("code",null,"sscanf"),l("返回值等于2就不爆炸，说明接受的输入数量是2个。")],-1),cs=s("p",null,[l("在这种情况下"),s("code",null,'"%d %d"'),l("指定了"),s("code",null,"sscanf"),l("接受的输入类型，使它只能接受两个输入，输入元素的数量大于2时返回值也是2，这样"),s("code",null,"secret_phase"),l("的进入条件不会影响"),s("code",null,"phase_4"),l("的正常通关。")],-1),os=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048cea:   83 f8 04                cmp    $0x4,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ced:   7e 05                   jle    8048cf4 <phase_4+0x3f>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cef:   e8 b2 03 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cf4:   8b 44 24 18             mov    0x18(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cf8:   89 44 24 04             mov    %eax,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cfc:   c7 04 24 06 00 00 00    movl   $0x6,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d03:   e8 50 ff ff ff          call   8048c58 <func4>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ps=s("p",null,[s("code",null,"mov 0x18(%esp),%eax"),l("、"),s("code",null,"cmp $0x1,%eax"),l("和"),s("code",null,"cmp $0x4,%eax"),l("限定输入的第二个数应该大于1且小于等于4，再将6和输入的第二个数（这里记作x和y）传入"),s("code",null,"func4"),l("。")],-1),ts=s("p",null,"func4：",-1),is=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048c58 <func4>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c58:   83 ec 1c                sub    $0x1c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c5b:   89 5c 24 10             mov    %ebx,0x10(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c5f:   89 74 24 14             mov    %esi,0x14(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c63:   89 7c 24 18             mov    %edi,0x18(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c67:   8b 74 24 20             mov    0x20(%esp),%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c6b:   8b 5c 24 24             mov    0x24(%esp),%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c6f:   85 f6                   test   %esi,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c71:   7e 2b                   jle    8048c9e <func4+0x46>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c73:   83 fe 01                cmp    $0x1,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c76:   74 2b                   je     8048ca3 <func4+0x4b>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ds=s("p",null,"先判断x是否等于0，等于0则返回0；再判断x是否为1，为1则返回y。",-1),Cs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048c78:   89 5c 24 04             mov    %ebx,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c7c:   8d 46 ff                lea    -0x1(%esi),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c7f:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c82:   e8 d1 ff ff ff          call   8048c58 <func4>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c87:   8d 3c 18                lea    (%eax,%ebx,1),%edi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c8a:   89 5c 24 04             mov    %ebx,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c8e:   83 ee 02                sub    $0x2,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c91:   89 34 24                mov    %esi,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c94:   e8 bf ff ff ff          call   8048c58 <func4>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c99:   8d 1c 07                lea    (%edi,%eax,1),%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c9c:   eb 05                   jmp    8048ca3 <func4+0x4b>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048c9e:   bb 00 00 00 00          mov    $0x0,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ca3:   89 d8                   mov    %ebx,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ca5:   8b 5c 24 10             mov    0x10(%esp),%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ca9:   8b 74 24 14             mov    0x14(%esp),%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cad:   8b 7c 24 18             mov    0x18(%esp),%edi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cb1:   83 c4 1c                add    $0x1c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048cb4:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),As=s("p",null,[l("剩下的部分，即x大于1时，把x-1的值和y当作参数调用"),s("code",null,"func4"),l("，返回值与y相加后存到"),s("code",null,"%edi"),l("，接着与这里类似，x减去2，把"),s("code",null,"x-2"),l("和"),s("code",null,"y"),l("当作参数调用"),s("code",null,"func4"),l("，返回值与之前存在"),s("code",null,"%edi"),l("中的值相加，所得结果作为返回值。")],-1),rs=s("p",null,"推测func4如下：",-1),xs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"int func4(int x, int y) {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  if(x == 0) {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    return 0;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  else if(x == 1) {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    return y;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  else {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    return func4(x-1, y)+y+func4(x-2, y);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),hs=s("p",null,[l("回到"),s("code",null,"phase4"),l("：")],-1),us=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048d08:   3b 44 24 1c             cmp    0x1c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d0c:   74 05                   je     8048d13 <phase_4+0x5e>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d0e:   e8 93 03 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d13:   83 c4 2c                add    $0x2c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d16:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ys=s("p",null,[s("code",null,"cmp 0x1c(%esp),%eax"),l("，将"),s("code",null,"func4"),l("的返回值与输入的第一个数比较，相等就跳过爆炸，那么输入的第一个数应该等于"),s("code",null,"func4"),l("的返回值，该返回值与输入的第二个数有关，答案不唯一。")],-1),bs=s("p",null,[l("当输入的第二个数为4时，"),s("code",null,"func4"),l("的返回值应该是80。")],-1),_s=s("p",null,[l("输入80 4，终端输出了"),s("code",null,"So you got that one. Try this one."),l("，第四关通过。")],-1),Ds=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/EhNXclznmLyHFGs.jpg",alt:"phase4"})],-1),ms={id:"第五关",tabindex:"-1"},fs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/* Round and 'round in memory we go, where we stop, the bomb blows! */")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),gs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048d17 <phase_5>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d17:   53                      push   %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d18:   83 ec 18                sub    $0x18,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d1b:   8b 5c 24 20             mov    0x20(%esp),%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d1f:   89 1c 24                mov    %ebx,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d22:   e8 54 02 00 00          call   8048f7b <string_length>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d27:   83 f8 06                cmp    $0x6,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d2a:   74 05                   je     8048d31 <phase_5+0x1a>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d2c:   e8 75 03 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),vs=s("p",null,[l("将输入的内容传到"),s("code",null,"(%esp)"),l("再调用"),s("code",null,"<string_length>"),l("，获取字符串长度并与6比较，长度为6才不爆炸。")],-1),$s=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048d31:   ba 00 00 00 00          mov    $0x0,%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d36:   b8 00 00 00 00          mov    $0x0,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d3b:   0f be 0c 03             movsbl (%ebx,%eax,1),%ecx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d3f:   83 e1 0f                and    $0xf,%ecx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d42:   03 14 8d c0 a1 04 08    add    0x804a1c0(,%ecx,4),%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d49:   83 c0 01                add    $0x1,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d4c:   83 f8 06                cmp    $0x6,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d4f:   75 ea                   jne    8048d3b <phase_5+0x24>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ks=s("p",null,[l("接下来是一个循环，用"),s("code",null,"movsbl (%ebx,%eax,1),%ecx"),l("和"),s("code",null,"and $0xf,%ecx"),l("获得输入的字符串中每个字符的二进制编码低四位，"),s("code",null,"add 0x804a1c0(,%ecx,4),%edx"),l("以每一步的四位编码作为偏移量在数组中找到对应的数，做累加，存到"),s("code",null,"%edx"),l("。")],-1),js=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048d51:   83 fa 35                cmp    $0x35,%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d54:   74 05                   je     8048d5b <phase_5+0x44>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d56:   e8 4b 03 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d5b:   83 c4 18                add    $0x18,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d5e:   5b                      pop    %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d5f:   90                      nop")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d60:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ts=s("p",null,[l("这里"),s("code",null,"cmp $0x35,%edx"),l("，将上一步获得的结果与0x35（转化成十进制是53）比较，相等则跳过爆炸。")],-1),ws=s("p",null,[l("在gdb中输入"),s("code",null,"x/16d 0x804a1c0"),l("，以十进制有符号数格式显示数组中的部分数值：")],-1),Is=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/nWz8EwikTUpqQ3d.jpg",alt:"nums"})],-1),Es=s("p",null,[l("只要输入的六个字符编码低四位作为偏移量对应数组元素之和等于53即可。比如输入字符a，ASCII码是"),s("code",null,"01100001"),l("，低四位是"),s("code",null,"0001"),l("，那么对应的数组元素就是"),s("code",null,"10"),l("。按照这个方法可以得出一组可能的答案："),s("code",null,"dehifk"),l("。答案不唯一。")],-1),Rs=s("p",null,[l("输入"),s("code",null,"dehifk"),l("，终端输出"),s("code",null,"Good work! On to the next..."),l("，第五关通过。")],-1),Bs=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/rig7bMAeZzaQyk1.jpg",alt:"phase5"})],-1),Ps={id:"第六关",tabindex:"-1"},Os=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/* This phase will never be used, since no one will get past the")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * earlier ones.  But just in case, make this one extra hard. */")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ms=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048d61 <phase_6>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d61:   56                      push   %esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d62:   53                      push   %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d63:   83 ec 44                sub    $0x44,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d66:   8d 44 24 10             lea    0x10(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d6a:   89 44 24 04             mov    %eax,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d6e:   8b 44 24 50             mov    0x50(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d72:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d75:   e8 61 04 00 00          call   80491db <read_six_numbers>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Vs=s("p",null,[l("由"),s("code",null,"<read_six_numbers>"),l("可以看出这一关需要输入六个数。")],-1),qs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048d7a:   be 00 00 00 00          mov    $0x0,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d7f:   8b 44 b4 10             mov    0x10(%esp,%esi,4),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d83:   83 e8 01                sub    $0x1,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d86:   83 f8 05                cmp    $0x5,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d89:   76 05                   jbe    8048d90 <phase_6+0x2f>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d8b:   e8 16 03 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d90:   83 c6 01                add    $0x1,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d93:   83 fe 06                cmp    $0x6,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d96:   74 33                   je     8048dcb <phase_6+0x6a>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ns=s("p",null,[l("这里进入一个循环，由"),s("code",null,"$0x0,%esi、mov 0x10(%esp,%esi,4),%eax"),l("、"),s("code",null,"sub $0x1,%eax"),l("和"),s("code",null,"cmp $0x5,%eax"),l("发现输入的数必须小于等于6（注意"),s("code",null,"%eax"),l("与5比较之前减去了1），"),s("code",null,"add $0x1,%esi、cmp $0x6,%esi"),l("是循环条件，保证遍历输入的6个数，确定其大小。")],-1),Ss=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048d98:   89 f3                   mov    %esi,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d9a:   8b 44 9c 10             mov    0x10(%esp,%ebx,4),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048d9e:   39 44 b4 0c             cmp    %eax,0xc(%esp,%esi,4)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048da2:   75 05                   jne    8048da9 <phase_6+0x48>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048da4:   e8 fd 02 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048da9:   83 c3 01                add    $0x1,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dac:   83 fb 05                cmp    $0x5,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048daf:   7e e9                   jle    8048d9a <phase_6+0x39>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048db1:   eb cc                   jmp    8048d7f <phase_6+0x1e>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Zs=s("p",null,[l("判断完一个数（记为"),s("code",null,"x"),l("）的大小后进行嵌套的循环，其中"),s("code",null,"mov 0x10(%esp,%ebx,4),%eax"),l("和"),s("code",null,"cmp %eax,0xc(%esp,%esi,4)"),l("把后面的数和x进行比较，不相等才不会引发爆炸。这一层循环比较x和它后面的所有数。这两层循环就能确定输入的所有数都不相等。")],-1),Ls=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048db3:   8b 52 08                mov    0x8(%edx),%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048db6:   83 c0 01                add    $0x1,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048db9:   39 c8                   cmp    %ecx,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dbb:   75 f6                   jne    8048db3 <phase_6+0x52>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"​")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dbd:   89 54 b4 28             mov    %edx,0x28(%esp,%esi,4);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dc1:   83 c3 01                add    $0x1,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dc4:   83 fb 06                cmp    $0x6,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dc7:   75 07                   jne    8048dd0 <phase_6+0x6f>;")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dc9:   eb 1c                   jmp    8048de7 <phase_6+0x86>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"​")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dcb:   bb 00 00 00 00          mov    $0x0,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"​")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dd0:   89 de                   mov    %ebx,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dd2:   8b 4c 9c 10             mov    0x10(%esp,%ebx,4),%ecx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dd6:   b8 01 00 00 00          mov    $0x1,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ddb:   ba 3c c1 04 08          mov    $0x804c13c,%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048de0:   83 f9 01                cmp    $0x1,%ecx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048de3:   7f ce                   jg     8048db3 <phase_6+0x52>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048de5:   eb d6                   jmp    8048dbd <phase_6+0x5c>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Us=s("p",null,[l("做完之前的检查后程序跳到了"),s("code",null,"8048dcb"),l("对应的行，这里也是一个循环，在这个循环中，以"),s("code",null,"0x804c13c"),l("为基址，之前输入的数减1再乘8作为偏移量，按数被输入的顺序将对应的元素存入栈帧。")],-1),Ws=s("p",null,[l("输入"),s("code",null,"x/20wx 0x804c13c"),l("，得到如下内容：")],-1),zs=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/IYUkiuCAZMjdDzb.jpg",alt:"contents"})],-1),Hs=s("p",null,"可以发现前面保存的内容都是地址的形式。由这些内容还可以看出应该输入的数是1到6这六个数。",-1),Ys=s("p",null,[l("如果输入的第一个数是"),s("code",null,"2"),l("，那么偏移量是"),s("code",null,"8"),l("，保存的地址就是"),s("code",null,"0x804c144"),l("处的内容"),s("code",null,"0x804c148"),l("。")],-1),Ks=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048de7:   8b 5c 24 28             mov    0x28(%esp),%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048deb:   8b 44 24 2c             mov    0x2c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048def:   89 43 08                mov    %eax,0x8(%ebx)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048df2:   8b 54 24 30             mov    0x30(%esp),%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048df6:   89 50 08                mov    %edx,0x8(%eax)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048df9:   8b 44 24 34             mov    0x34(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048dfd:   89 42 08                mov    %eax,0x8(%edx)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e00:   8b 54 24 38             mov    0x38(%esp),%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e04:   89 50 08                mov    %edx,0x8(%eax)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e07:   8b 44 24 3c             mov    0x3c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e0b:   89 42 08                mov    %eax,0x8(%edx)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e0e:   c7 40 08 00 00 00 00    movl   $0x0,0x8(%eax)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Xs=s("p",null,[l("之前保存完地址之后，程序按顺序将这些地址指向的数也保存进栈帧，按照上面假设的情况，保存的第一项是"),s("code",null,"0x143"),l("。")],-1),Js=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048e15:   be 05 00 00 00          mov    $0x5,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e1a:   8b 43 08                mov    0x8(%ebx),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e1d:   8b 10                   mov    (%eax),%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e1f:   39 13                   cmp    %edx,(%ebx)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e21:   7e 05                   jle    8048e28 <phase_6+0xc7>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e23:   e8 7e 02 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"​")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e28:   8b 5b 08                mov    0x8(%ebx),%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e2b:   83 ee 01                sub    $0x1,%esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e2e:   75 ea                   jne    8048e1a <phase_6+0xb9>；aaa")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"​")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e30:   83 c4 44                add    $0x44,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e33:   5b                      pop    %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e34:   5e                      pop    %esi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e35:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Qs=s("p",null,[l("在这之后，进行比较排序。"),s("code",null,"mov 0x8(%ebx),%eax"),l("、"),s("code",null,"mov (%eax),%edx"),l("和"),s("code",null,"cmp %edx,(%ebx)"),l("每次都取一项与前一项进行比较，前一项小于后一项才不会爆炸。"),s("code",null,"sub $0x1,%esi"),l("、"),s("code",null,"jne 8048e1a <phase_6+0xb9>"),l("是循环条件。")],-1),Fs=s("p",null,"可以发现保存的数与输入的数的对应关系：",-1),Gs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"277 1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"143 2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1f3 3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"31d 4")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"281 5")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8c  6")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),sl=s("p",null,"按升序排列：",-1),ll=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8c  6")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"143 2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1f3 3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"277 1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"281 5")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"31d 4")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),el=s("p",null,"也就是说输入数的顺序应该是6、2、3、1、5、4。",-1),nl=s("p",null,[l("输入"),s("code",null,"6 2 3 1 5 4"),l("，终端输出了"),s("code",null,"Congratulations! You've defused the bomb!"),l("，第六关通过。")],-1),al=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/4yp7FVA1wiEMkrI.jpg",alt:"phase6"})],-1),cl={id:"隐藏关卡",tabindex:"-1"},ol=s("p",null,"看起来我们已经解决了所有问题，但是事情好像并不像我们想得那么简单。",-1),pl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/* Wow, they got it!  But isn't something... missing?  Perhaps")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * something they overlooked?  Mua ha ha ha ha! */")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),tl=s("p",null,"这赤裸裸的嘲讽，能忍吗？（doge）",-1),il=s("p",null,[l("发现汇编代码中存在"),s("code",null,"secret_phase"),l("，但是之前的过程并没有用到，猜测它是一个隐藏关卡。")],-1),dl={id:"进入条件",tabindex:"-1"},Cl=s("p",null,[l("为了找到进入该关卡的条件，在汇编代码中寻找"),s("code",null,"secret_phase"),l("，发现只有"),s("code",null,"phase_defused"),l("调用了该函数。")],-1),Al=s("p",null,[l("首先分析"),s("code",null,"phase_defused"),l("，它在通过每一个关卡后被调用。")],-1),rl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"0804922b <phase_defused>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804922b:   81 ec 8c 00 00 00       sub    $0x8c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049231:   65 a1 14 00 00 00       mov    %gs:0x14,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049237:   89 44 24 7c             mov    %eax,0x7c(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804923b:   31 c0                   xor    %eax,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804923d:   83 3d cc c3 04 08 06    cmpl   $0x6,0x804c3cc")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049244:   75 72                   jne    80492b8 <phase_defused+0x8d>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),xl=s("p",null,[s("code",null,"cmpl $0x6,0x804c3cc"),l("可能与通过之前六关有关，没有全部通过就不会触发隐藏关卡。")],-1),hl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8049246:   8d 44 24 2c             lea    0x2c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804924a:   89 44 24 10             mov    %eax,0x10(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804924e:   8d 44 24 28             lea    0x28(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049252:   89 44 24 0c             mov    %eax,0xc(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049256:   8d 44 24 24             lea    0x24(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804925a:   89 44 24 08             mov    %eax,0x8(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804925e:   c7 44 24 04 91 a3 04    movl   $0x804a391,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049265:   08 ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049266:   c7 04 24 d0 c4 04 08    movl   $0x804c4d0,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804926d:   e8 fe f5 ff ff          call   8048870 <__isoc99_sscanf@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ul=s("p",null,[l("把两个立即数地址传给"),s("code",null,"<__isoc99_sscanf@plt>"),l("。查看第一个地址（"),s("code",null,"x/s 0x804a391"),l("）发现是"),s("code",null,'"%d %d %s"'),l("，应该输入两个整数和一个字符串。后一个地址"),s("code",null,"0x804c4d0"),l("应该是输入时的地址，查看每一个关卡输入时的地址，发现"),s("strong",null,"第四关"),l("输入时的地址正好是"),s("code",null,"0x804c4d0"),l("。")],-1),yl=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/x7tO5IuYpvTCgKE.jpg",alt:"input4"})],-1),bl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8049272:   83 f8 03                cmp    $0x3,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049275:   75 35                   jne    80492ac <phase_defused+0x81>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049277:   c7 44 24 04 9a a3 04    movl   $0x804a39a,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804927e:   08 ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804927f:   8d 44 24 2c             lea    0x2c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049283:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049286:   e8 09 fd ff ff          call   8048f94 <strings_not_equal>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804928b:   85 c0                   test   %eax,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804928d:   75 1d                   jne    80492ac <phase_defused+0x81>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804928f:   c7 04 24 60 a2 04 08    movl   $0x804a260,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8049296:   e8 65 f5 ff ff          call   8048800 <puts@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 804929b:   c7 04 24 88 a2 04 08    movl   $0x804a288,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492a2:   e8 59 f5 ff ff          call   8048800 <puts@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492a7:   e8 db fb ff ff          call   8048e87 <secret_phase>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"​")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492ac:   c7 04 24 c0 a2 04 08    movl   $0x804a2c0,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492b3:   e8 48 f5 ff ff          call   8048800 <puts@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492b8:   8b 44 24 7c             mov    0x7c(%esp),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492bc:   65 33 05 14 00 00 00    xor    %gs:0x14,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492c3:   74 05                   je     80492ca <phase_defused+0x9f>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492c5:   e8 06 f5 ff ff          call   80487d0 <__stack_chk_fail@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492ca:   81 c4 8c 00 00 00       add    $0x8c,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 80492d0:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),_l=s("p",null,[l("将"),s("code",null,"<__isoc99_sscanf@plt>"),l("的返回值与3比较，猜测该返回值应该是参数的数量，等于3才可能解锁隐藏关。然后又传递了一个地址"),s("code",null,"0x804a39a"),l("，将该地址处的字符串与输入的字符串比较，相等才能解锁隐藏关。在gdb中输入"),s("code",null,"x/s 0x804a39a"),l("，得到该处的字符串是"),s("code",null,"DrEvil"),l("。")],-1),Dl=s("p",null,[l("所以在进行第四关时，输入两个数后再输入"),s("code",null,"DrEvil"),l("，通过第六关之后即可进入"),s("code",null,"secret_phase"),l("。第四关里面获取输入元素数量也使用了"),s("code",null,"<__isoc99_sscanf@plt>"),l("，在那里给的参数是"),s("code",null,'"%d %d"'),l("，应该是只能接受两个输入，即使输入了三个，返回值也会是2，第四关的通关不受影响。")],-1),ml=s("p",null,"进入secret_phase：",-1),fl=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/CRqUj6n8Ki7ZlDd.jpg",alt:"enter-sp"})],-1),gl={id:"分析secret-phase",tabindex:"-1"},vl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048e87 <secret_phase>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e87:   53                      push   %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e88:   83 ec 18                sub    $0x18,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e8b:   e8 3d 02 00 00          call   80490cd <read_line>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e90:   c7 44 24 08 0a 00 00    movl   $0xa,0x8(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e97:   00 ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e98:   c7 44 24 04 00 00 00    movl   $0x0,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e9f:   00 ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ea0:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ea3:   e8 38 fa ff ff          call   80488e0 <strtol@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),$l=s("p",null,[l("由"),s("code",null,"<read_line>"),l("可知要有一行输入，然后输入的内容和"),s("code",null,"0xa"),l("、"),s("code",null,"0x0"),l("两个立即数一起作为"),s("code",null,"<strtol@plt>"),l("的参数。"),s("code",null,"<strtol@plt>"),l("的作用是把参数按照其base（即进制）转换成长整型数，由此可知应该输入的是一个数。")],-1),kl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048ea8:   89 c3                   mov    %eax,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048eaa:   8d 40 ff                lea    -0x1(%eax),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ead:   3d e8 03 00 00          cmp    $0x3e8,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048eb2:   76 05                   jbe    8048eb9 <secret_phase+0x32>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048eb4:   e8 ed 01 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),jl=s("p",null,"输入的数应该小于等于1001。",-1),Tl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048eb9:   89 5c 24 04             mov    %ebx,0x4(%esp);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ebd:   c7 04 24 88 c0 04 08    movl   $0x804c088,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ec4:   e8 6d ff ff ff          call   8048e36 <fun7>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ec9:   83 f8 07                cmp    $0x7,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ecc:   74 05                   je     8048ed3 <secret_phase+0x4c>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ece:   e8 d3 01 00 00          call   80490a6 <explode_bomb>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),wl=s("p",null,[l("把地址"),s("code",null,"0x804c088"),l("和输入的数作为参数调用"),s("code",null,"fun7"),l("。要求"),s("code",null,"fun7"),l("的返回值等于7。")],-1),Il=s("p",null,[l("接下来分析"),s("code",null,"fun7"),l("：")],-1),El=s("p",null,[l("记"),s("code",null,"fun7"),l("的参数为"),s("code",null,"x"),l("和"),s("code",null,"y"),l("，在"),s("code",null,"secret_phase"),l("中调用时"),s("code",null,"x"),l("是一个地址。")],-1),Rl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"08048e36 <fun7>:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e36:   53                      push   %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e37:   83 ec 18                sub    $0x18,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e3a:   8b 54 24 20             mov    0x20(%esp),%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e3e:   8b 4c 24 24             mov    0x24(%esp),%ecx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e42:   85 d2                   test   %edx,%edx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e44:   74 37                   je     8048e7d <fun7+0x47>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Bl=s("p",null,[l("它是一个递归函数，当x为0时返回"),s("code",null,"0xffffffff"),l("。不过"),s("code",null,"secret_phase"),l("传给它的x不为0。")],-1),Pl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048e46:   8b 1a                   mov    (%edx),%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e48:   39 cb                   cmp    %ecx,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e4a:   7e 13                   jle    8048e5f <fun7+0x29>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e4c:   89 4c 24 04             mov    %ecx,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e50:   8b 42 04                mov    0x4(%edx),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e53:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e56:   e8 db ff ff ff          call   8048e36 <fun7>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e5b:   01 c0                   add    %eax,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e5d:   eb 23                   jmp    8048e82 <fun7+0x4c>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ol=s("p",null,"若x不为0，当x指向的值大于y，将地址x加4，和y一起作为参数调用fun7，返回其返回值的2倍。当x指向的值等于y，返回0。",-1),Ml=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048e5f:   b8 00 00 00 00          mov    $0x0,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e64:   39 cb                   cmp    %ecx,%ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e66:   74 1a                   je     8048e82 <fun7+0x4c>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"​")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e68:   89 4c 24 04             mov    %ecx,0x4(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e6c:   8b 42 08                mov    0x8(%edx),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e6f:   89 04 24                mov    %eax,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e72:   e8 bf ff ff ff          call   8048e36 <fun7>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"​")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e77:   8d 44 00 01             lea    0x1(%eax,%eax,1),%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e7b:   eb 05                   jmp    8048e82 <fun7+0x4c>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Vl=s("p",null,"当x指向的值小于y，将地址x加8，和y一起作为参数调用fun7，返回其返回值的2倍加1。",-1),ql=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048e7d:   b8 ff ff ff ff          mov    $0xffffffff,%eax")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e82:   83 c4 18                add    $0x18,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e85:   5b                      pop    %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048e86:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Nl=s("p",null,[l("最终需要的返回值是7，最内层返回值应该是0，即在最内层x所指向的值与y相等，再往外一层返回2"),s("em",null,"0+1，再往外一层返回2"),l("1+1，最外层返回2*3+1。")],-1),Sl=s("p",null,[l("输入"),s("code",null,"x/44x 0x804c088"),l("查看保存的值。")],-1),Zl=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/rIbYyvn1j2AHZa7.jpg",alt:"values"})],-1),Ll=s("p",null,[s("code",null,"secret_phase"),l("调用"),s("code",null,"fun7"),l("时，x为"),s("code",null,"0x804c088"),l("，y是输入的数。")],-1),Ul=s("p",null,[s("code",null,"0x804c088+8"),l("等于"),s("code",null,"0x804c090"),l("，该处存放的值为"),s("code",null,"0x804c0a0"),l("，是一个地址。")],-1),Wl=s("p",null,[s("code",null,"0x804c0a0+8"),l("等于"),s("code",null,"0x804c0a8"),l("，该处存放的值为"),s("code",null,"0x804c0d0"),l("，是一个地址。")],-1),zl=s("p",null,[s("code",null,"0x804c0d0+8"),l("等于"),s("code",null,"0x804c0d8"),l("，该处存放的值为"),s("code",null,"0x804c130"),l("，是一个地址。")],-1),Hl=s("p",null,[l("地址"),s("code",null,"0x804c130"),l("处保存了一个数，0x3e9，转换成十进制是1001，它应该等于y。")],-1),Yl=s("p",null,[l("返回到"),s("code",null,"secret_phase"),l(":")],-1),Kl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"8048ed3:   c7 04 24 00 a2 04 08    movl   $0x804a200,(%esp)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048eda:   e8 21 f9 ff ff          call   8048800 <puts@plt>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048edf:   e8 47 03 00 00          call   804922b <phase_defused>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ee4:   83 c4 18                add    $0x18,%esp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ee7:   5b                      pop    %ebx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 8048ee8:   c3                      ret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Xl=s("p",null,[s("code",null,"fun7(0x804c088, 1001)"),l("的返回值应该是7，使得程序输出通关信息，正常返回。也就是说，要通过"),s("code",null,"secret_phase"),l("，应该输入"),s("code",null,"1001"),l("。")],-1),Jl=s("p",null,[l("输入"),s("code",null,"1001"),l("，终端输出了"),s("code",null,"Wow! You've defused the secret stage!"),l("，隐藏的秘密关卡通过。")],-1),Ql=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/oSlURyD4XP8NbhZ.jpg",alt:"sp"})],-1),Fl={id:"通关",tabindex:"-1"},Gl=s("p",null,[s("img",{src:"https://i.loli.net/2021/06/05/TpuSW5DxAa8yQje.jpg",alt:"victory"})],-1),se=s("p",null,"有几关的答案不唯一。这个实验每个人的题目不太一样，不过在网上能找到很多类似的题解来提供思路。和身边的人对比起来，我抽到的题目算是比较常规吧。邪恶博士，谢谢你（才怪）。",-1);function le(n,ee,ne,ae,t,ce){const a=h,i=d;return r(),A(i,{frontmatter:t.frontmatter,data:t.data},{"main-content-md":e(()=>[s("h2",b,[l("拆掉邪恶博士的炸弹 "),c(a,{class:"header-anchor",href:"#拆掉邪恶博士的炸弹","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),_,s("h3",D,[l("邪恶博士的幽默感 "),c(a,{class:"header-anchor",href:"#邪恶博士的幽默感","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),m,f,g,x(" more "),s("h3",v,[l("第一关 "),c(a,{class:"header-anchor",href:"#第一关","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),$,k,j,T,w,I,E,R,B,s("h3",P,[l("第二关 "),c(a,{class:"header-anchor",href:"#第二关","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),O,M,V,q,N,S,Z,L,s("h3",U,[l("第三关 "),c(a,{class:"header-anchor",href:"#第三关","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),W,z,H,Y,K,X,J,Q,F,G,ss,s("h3",ls,[l("第四关 "),c(a,{class:"header-anchor",href:"#第四关","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),es,ns,as,cs,os,ps,ts,is,ds,Cs,As,rs,xs,hs,us,ys,bs,_s,Ds,s("h3",ms,[l("第五关 "),c(a,{class:"header-anchor",href:"#第五关","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),fs,gs,vs,$s,ks,js,Ts,ws,Is,Es,Rs,Bs,s("h3",Ps,[l("第六关 "),c(a,{class:"header-anchor",href:"#第六关","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),Os,Ms,Vs,qs,Ns,Ss,Zs,Ls,Us,Ws,zs,Hs,Ys,Ks,Xs,Js,Qs,Fs,Gs,sl,ll,el,nl,al,s("h3",cl,[l("隐藏关卡 "),c(a,{class:"header-anchor",href:"#隐藏关卡","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),ol,pl,tl,il,s("h4",dl,[l("进入条件 "),c(a,{class:"header-anchor",href:"#进入条件","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),Cl,Al,rl,xl,hl,ul,yl,bl,_l,Dl,ml,fl,s("h4",gl,[l("分析secret_phase "),c(a,{class:"header-anchor",href:"#分析secret-phase","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),vl,$l,kl,jl,Tl,wl,Il,El,Rl,Bl,Pl,Ol,Ml,Vl,ql,Nl,Sl,Zl,Ll,Ul,Wl,zl,Hl,Yl,Kl,Xl,Jl,Ql,s("h3",Fl,[l("通关 "),c(a,{class:"header-anchor",href:"#通关","aria-hidden":"true"},{default:e(()=>[l("#")]),_:1})]),Gl,se]),"main-header":e(()=>[o(n.$slots,"main-header")]),"main-header-after":e(()=>[o(n.$slots,"main-header-after")]),"main-nav":e(()=>[o(n.$slots,"main-nav")]),"main-content":e(()=>[o(n.$slots,"main-content")]),"main-content-after":e(()=>[o(n.$slots,"main-content-after")]),"main-nav-before":e(()=>[o(n.$slots,"main-nav-before")]),"main-nav-after":e(()=>[o(n.$slots,"main-nav-after")]),comment:e(()=>[o(n.$slots,"comment")]),footer:e(()=>[o(n.$slots,"footer")]),aside:e(()=>[o(n.$slots,"aside")]),"aside-custom":e(()=>[o(n.$slots,"aside-custom")]),default:e(()=>[o(n.$slots,"default")]),_:3},8,["frontmatter","data"])}const Ae=C(y,[["render",le]]);export{Ce as __pageData,Ae as default};
